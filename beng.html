<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Generator AI Gambar & Video</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4 font-sans">

<div class="w-full max-w-2xl bg-white rounded-xl shadow-lg p-6 md:p-8">
    <h1 class="text-3xl font-bold text-center mb-4">Gambar & Video Generator</h1>
    <!-- Mode -->
    <div class="mb-4">
        <label class="block mb-1 font-semibold">Mode:</label>
        <select id="mode" class="w-full px-4 py-2 border rounded">
            <option value="video">Video</option>
            <option value="image">Gambar</option>
        </select>
    </div>
    <!-- Prompt -->
    <div class="mb-4">
        <label class="block mb-1 font-semibold">Prompt / Deskripsi:</label>
        <input type="text" id="prompt" class="w-full px-4 py-2 border rounded" placeholder="Contoh: pemandangan pegunungan" />
    </div>
    <!-- API Key -->
    <div class="mb-4">
        <label class="block mb-1 font-semibold">API Key:</label>
        <input type="text" id="apiKey" class="w-full px-4 py-2 border rounded" placeholder="API Key Anda" value="ribeng121" />
    </div>
    <!-- Tombol -->
    <div class="mb-4">
        <button id="generate" class="w-full bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700">Buat Sekarang</button>
    </div>
    <!-- Hasil -->
    <div id="result" class="mt-4 flex justify-center items-center min-h-[200px] bg-gray-200 rounded-lg overflow-hidden">
        <p class="text-gray-500">Hasil akan muncul di sini</p>
    </div>
</div>

<script>
const btn = document.getElementById('generate');
const modeSelect = document.getElementById('mode');
const promptInput = document.getElementById('prompt');
const apiKeyInput = document.getElementById('apiKey');
const resultDiv = document.getElementById('result');

btn.addEventListener('click', async () => {
    const mode = modeSelect.value;
    const prompt = promptInput.value.trim();
    const apiKey = apiKeyInput.value.trim();

    if (!prompt || !apiKey) {
        alert('Mohon isi Prompt dan API Key.');
        return;
    }

    // Tampilkan loading
    resultDiv.innerHTML = '<div class="loader mx-auto"></div>';

    try {
        let apiUrl = '';
        if (mode === 'video') {
            apiUrl = `https://api.ibeng.my.id/api/ai/txt2video?query=${encodeURIComponent(prompt)}&apikey=${encodeURIComponent(apiKey)}`;
        } else {
            apiUrl = `https://api.ibeng.my.id/api/ai/txt2img?query=${encodeURIComponent(prompt)}&apikey=${encodeURIComponent(apiKey)}`;
        }

        const response = await fetch(apiUrl);
        if (!response.ok) {
            const errorData = await response.json().catch(() => response.text());
            throw new Error('Gagal mendapatkan data: ' + (errorData.message || response.statusText));
        }

        const json = await response.json();
        const data = json.data;
        const mediaUrl = data.url; // URL hasil media

        // Periksa Content-Type dari response header
        const contentType = response.headers.get('content-type');

        if (mediaUrl) {
            if (contentType && contentType.startsWith('video/')) {
                // Tampilkan video
                resultDiv.innerHTML = `<video src="${mediaUrl}" controls autoplay muted loop class="w-full h-auto rounded-lg"></video>`;
            } else if (contentType && contentType.startsWith('image/')) {
                // Tampilkan gambar
                resultDiv.innerHTML = `<img src="${mediaUrl}" alt="Hasil" class="w-full h-auto rounded-lg" />`;
            } else {
                // Jika content-type tidak dikenali
                resultDiv.innerHTML = `<p class="text-red-500 p-4">Tipe media tidak dikenali: ${contentType}</p>`;
            }
        } else {
            resultDiv.innerHTML = `<p class="text-red-500 p-4">URL media tidak ditemukan dalam response.</p>`;
        }

    } catch (err) {
        resultDiv.innerHTML = `<p class="text-red-500 p-4">Error: ${err.message}</p>`;
        console.error(err);
    }
});

// Jika mode video dipilih, otomatis tampilkan input prompt
modeSelect.addEventListener('change', () => {
    // Bisa dikembangkan jika perlu
});
</script>

</body>
</html>
